import pandas as pd
import geopandas as gpd
import matplotlib.pyplot as plt

test_data_path = 'test_wage_data.csv'
seattle_map_path = 'Seattle_Area_Polygon\Seattle_Area_Poly.shp'


def print_data(data: pd.DataFrame) -> None:
    """
    given a dataframe, prints out the first few rows of data.
    """
    print(data.head())


def filter_data(data: pd.DataFrame) -> pd.DataFrame:
    """
    given a dataframe, the function filter_data filters
    the wage dataset, and return the filtered dataset.
    """

    filtered_df = data.loc[:, ['Department', 'Hourly Rate']]
    return filtered_df

# the map_construction function is purely for generating a seattle map
# to better introduce Seattle; gonna use this map for slides/presentation
def map_construction(seattle_map: gpd.GeoDataFrame) -> None:
    """
    given a gpd.geodataframe object, generate a map and save as
    Seattle_map.png. Returns nothing
    """
    seattle_geom = seattle_map[['geometry']]
    seattle_geom = seattle_geom.to_crs('EPSG:4326')

    fig, ax = plt.subplots(1, figsize=(10, 10))
    seattle_geom.plot(ax=ax, color='#CACACA')
    fig.savefig('Seattle_map.png')


def main():
    test_data = pd.read_csv(test_data_path)
    filtered_df = filter_data(test_data)
    seattle_map = gpd.read_file(seattle_map_path)
    map_construction(seattle_map)



if __name__ == "__main__":
    main()